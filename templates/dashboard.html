<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Zephyr CMS â€“ Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<header class="header">
  <h1>ğŸ” Busog Pinas Dashboard</h1>
  <div class="dashboard-greeting">
    Hello {{ session.get('role') | capitalize }} ({{ display_name }})
  </div>
  <div class="dashboard-actions">
    <a href="{{ url_for('add_customer_page') }}">â• Add Customer</a>
    <a href="{{ url_for('customer_records') }}">ğŸ“… View Old Records</a>
    <a href="{{ url_for('view_feedback') }}">ğŸ’¬ Feedback</a>
    <a href="{{ url_for('profile') }}">ğŸ‘¤ Profile</a>
    {% if session.get('role') == "admin" %}
      <a href="{{ url_for('archived_customers') }}">ğŸ“¦ Archived</a>
      <a href="{{ url_for('activity_logs') }}">ğŸ“œ Logs</a>
    {% endif %}
    <a href="{{ url_for('logout') }}" class="logout-btn">Logout</a>
  </div>
</header>

<section class="stats-bar">
  <div class="stat-card">
    <span>Customers Today</span>
    <strong>{{ today_count }}</strong>
  </div>
  <div class="stat-card">
    <span>Total Earnings</span>
    <strong>â‚±{{ total_earnings }}</strong>
  </div>
  <div class="stat-card">
    <span>Today</span>
    <strong>â‚±{{ daily_earnings }}</strong>
  </div>
  <div class="stat-card">
    <span>This Month</span>
    <strong>â‚±{{ monthly_earnings }}</strong>
  </div>
</section>

<section class="dashboard-section">
  <h2>Today's Customers</h2>

  {% if customers %}
  <table class="customer-table">
    <thead>
      <tr>
        <th>Name</th>
        <th>Order</th>
        <th>Total Amount</th>
        <th>Visit Date</th>
        <th>Visits</th>
        <th>Category</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      {% for c in customers %}
      <tr>
        <td>{{ c.name }}</td>
        <td>{{ c.order_name }}</td>
        <td><strong>â‚± {{ "%.2f"|format(c.amount) }}</strong></td>
        <td>{{ c.visit_date }}</td>
        <td>{{ c.visit_count }}</td>
        <td>{{ c.category }}</td>
        <td>
          <form method="POST" action="{{ url_for('delete_customer', customer_id=c.id) }}"
            onsubmit="return confirm('Are you sure you want to delete this customer?');">
            <button type="submit" style="background:#ff4d4d;color:white;border:none;padding:6px 12px;border-radius:6px;cursor:pointer;">
              ğŸ—‘ Delete
            </button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
    <p>No customers yet today.</p>
  {% endif %}
</section>

<footer class="footer">
  Logged in as <strong>{{ session.get('user') }}</strong> ({{ session.get('role') | capitalize }})
</footer>

</body>
</html>
